---
import Estructura from "../Components/Estructura.astro";
---

<Estructura>
   <div id="modal" class="fixed inset-0 bg-black/80 z-[1001] hidden">
        <div class="bg-white max-w-[300px] p-[25px] mx-auto rounded-md mt-[22%]">
            <h1 class="text-center">Registro enviado correctamente</h1>
        </div>
   </div>
	<section class="pt-[184px] mx-[100px] pb-[120px] ">
        <div id="container" class="max-w-[1240px] mx-auto">
            <div id="flex" class="flex gap-[20px] h-[900px]">
                <div id="flexchild1" class="w-1/2 bg-Azul rounded-[10px] px-[55px] py-[7%] shadow-xl">
                    <h1 class="font-Cocogoose text-[280%] leading-[0.9] mb-[45px] text-white">Contacta con Nosotros</h1>
                
                    <form action="/" id="contactanos" name="contactanos" method="POST" data-netlify="true">
                        <div id="flex1_form" class="flex gap-[30px] mb-[25px]">
                            <div id="child1" class="w-1/2 relative">
                                <label for="nombre" class="block font-Figtree italic font-semibold text-[110] text-Amarillo pb-[6px]">Nombre u Organización</label>
                                <input type="text" class="bg-[#EAECEE] px-[5px] font-Figtree font-thin text-[94%] text-black rounded-[5px] min-h-[35px] w-full outline-none border-[1px] border-Amarillo focus:ring-2 focus:ring-Amarillo invalid:focus:ring-red-600" name="nombre" id="nombre" required>
                                <p id="nombreError" class="absolute bottom-[-25px] text-red-600 font-Figtree font-semibold hidden">Caracteres invalidos, revisa</p>
                            </div>
                            <div id="child2" class="w-1/2">
                                <label for="correo" class="block font-Figtree italic font-semibold text-[110] text-Amarillo pb-[6px]">Correo Electrónico</label>
                                <input type="email" class="bg-[#EAECEE] px-[5px] font-Figtree font-thin text-[94%] text-black rounded-[5px] min-h-[35px] w-full outline-none border-[1px] border-Amarillo focus:ring-2 focus:ring-Amarillo invalid:focus:ring-red-600" name="correo" id="correo" required>
                            </div>
                        </div>
                        <div id="flex1_form" class="flex gap-[30px] mb-[25px]">
                            <div id="child1" class="w-1/2">
                                <label for="telefono" class="block font-Figtree italic font-semibold text-[110] text-Amarillo pb-[6px]">Teléfono o celular</label>
                                <input type="text" class="bg-[#EAECEE] px-[5px] font-Figtree font-thin text-[94%] text-black rounded-[5px] min-h-[35px] w-full outline-none border-[1px] border-Amarillo focus:ring-2 focus:ring-Amarillo invalid:focus:ring-red-600" name="telefono" id="telefono" required>
                            </div>
                            <div id="child2" class="w-1/2">
                                <label for="correo" class="block font-Figtree italic font-semibold text-[110] text-Amarillo pb-[6px]">Medio de contacto </label>
                                <select class="bg-[#EAECEE] px-[5px] font-Figtree font-thin text-[94%] text-black rounded-[5px] min-h-[35px] w-full outline-none border-[1px] border-Amarillo focus:ring-2 focus:ring-Amarillo invalid:focus:ring-red-600" name="medio[]" id="medio">
                                    <option value="Whatsapp" class="text-sm text-Azul">WhatsApp</option>
                                    <option value="Correo" class="text-sm text-Azul">Correo Electrónico</option>
                                </select>
                            </div>
                        </div>
                       
                        <label for="asunto" class="block font-Figtree italic font-semibold text-[110] text-Amarillo pb-[6px]">Asunto</label>
                        <textarea class="bg-[#EAECEE] px-[6px] pt-[6px] font-Figtree font-thin text-[94%] leading-[1.2] min-h-[50px] max-h-[50px] text-black rounded-[5px] w-full outline-none border-[1px] border-Amarillo focus:ring-2 focus:ring-Amarillo invalid:focus:ring-red-600 mb-[25px] relative" name="asunto" id="asunto" rows="2" required></textarea>
                        <p id="asuntoError" class="absolute bottom-[-6px] text-red-600 font-Figtree font-semibold mb-[10px] hidden">Caracteres invalidos, revisa</p>

                        <div class="relative">
                            <label for="mensaje" class="block font-Figtree italic font-semibold text-[110] text-Amarillo pb-[6px]">Mensaje</label>
                            <textarea class="bg-[#EAECEE] pl-[6px] pr-[15px] pt-[6px] font-Figtree font-thin text-[94%] text-justify leading-[1.2] min-h-[140px] max-h-[140px] text-black rounded-[5px] w-full outline-none border-[1px] border-Amarillo focus:ring-2 focus:ring-Amarillo invalid:focus:ring-red-600 mb-[30px]" name="mensaje" id="mensaje" rows="15" required></textarea>
                            <p id="mensajeError" class="absolute bottom-[-6px] text-red-600 font-Figtree font-semibold mb-[10px] hidden">Caracteres invalidos, revisa</p>
                        </div>
                            
                        <label class="flex items-center space-x-2 mb-[30px]">
                            <input type="checkbox" class="h-5 w-5 text-Amarillo rounded-2xl" required>
                            <span class="text-white hover:underline font-Figtree italic font-extralight text-[80%]"><a href="/">He leído y acepto las políticas de tratamiento de datos</a></span>
                        </label>

                        <button type="submit" class="py-[16px] px-[15%] bg-Amarillo font-Figtree font-bold text-white text-[105%] rounded-[8px] disabled:bg-Amarillo/90" id="bEnviar">Enviar</button>
                    </form>
                </div>
                
                <div id="flexchild2" class="flex flex-col gap-[20px] w-1/2">

                    <div class="bg-[url('/images/Contactanos_image.jpg')] bg-cover w-full h-1/2  rounded-[10px] shadow-md"> 
                       
                    </div>
                    <div class="bg-Azul w-full h-1/2 pt-[10%] rounded-[10px] shadow-md">
                       <h2 class="font-Figtree font-semibold italic max-w-[400px] mx-auto text-white text-[180%] leading-[1] mb-[40px] ">Conéctate a la red IdeaPro,
                        #ValoraLoPublico</h2>
                       <a href="https://tailwindcss.com/docs/font-style" target="_blank" class="group">
                        <div id="flex2" class="flex items-center gap-[20px] rounded-[10px] mx-auto max-w-[400px] mb-[25px] pl-[6px] py-[4px] group-hover:bg-Amarillo transition-colors duration-500">
                            <div id="flexChild1">
                               <img src="/images/Whatsapp.png" alt="" class="w-[50px]">
                            </div>
                            <div id="flexChild2">
                               <p class="font-Figtree leading-[1.2] text-white text-[110%]">
                                   <span class="block font-bold">Whatsapp</span>
                                   <span class="font-extralight">301563984</span>
                               </p>
                               
                            </div>
   
                           </div>
                       </a>
                       <a href="https://tailwindcss.com/docs/font-style" target="_blank" class="group">
                        <div id="flex2" class="flex  items-center gap-[20px]  rounded-[10px] mx-auto max-w-[400px] mb-[25px] pl-[6px] py-[4px] group-hover:bg-Amarillo transition-colors duration-500">
                            <div id="flexChild1">
                               <img src="/images/Correo.png" alt="" class="w-[50px]">
                            </div>
                            <div id="flexChild2">
                               <p class="font-Figtree leading-[1.2] text-white text-[110%]">
                                   <span class="block font-bold">Correo Electrónico</span>
                                   <span class="font-extralight">ideaproconsultores.gmail.com</span>
                               </p>
                               
                            </div>
   
                           </div>
                       </a>
                       <a href="https://tailwindcss.com/docs/font-style" target="_blank" class="group">
                        <div id="flex2" class="flex  items-center gap-[20px]  rounded-[10px] mx-auto max-w-[400px] pl-[6px] py-[4px] group-hover:bg-Amarillo transition-colors duration-500">
                            <div id="flexChild1">
                               <img src="/images/Linkedin.png" alt="" class="w-[50px]">
                            </div>
                            <div id="flexChild2">
                               <p class="font-Figtree leading-[1.2] text-white text-[110%]">
                                   <span class="block font-bold">LinkedIn</span>
                                   <span class="font-extralight">IDEAPRO Consultores</span>
                               </p>
                               
                            </div>
   
                           </div>
                       </a>
                    </div>
                </div>
            </div>
        </div>
    </section>
</Estructura>

<script>

    const datos = {
        nombre: '',
        asunto: '',
        mensaje: ''
    }

	window.onload = function(){
	 const boton = document.querySelector('#bEnviar')
     const modal = document.querySelector('#modal')
	 const nombreError = document.querySelector('#nombreError')
	 const nombre = document.querySelector('#nombre')
	 const asuntoError  = document.querySelector('#asuntoError')
	 const asunto = document.querySelector('#asunto')
	 const mensajeError = document.querySelector('#mensajeError')
	 const mensaje = document.querySelector('#mensaje')
     const formulario = document.querySelector('#contactanos')
 
	 mensaje.addEventListener('input', (evento) => comprobarString(evento, mensajeError))
	 nombre.addEventListener('input', (evento) => comprobarString(evento, nombreError))
	 asunto.addEventListener('input', (evento) => comprobarString(evento, asuntoError))
     formulario.addEventListener('submit', function(evento){
        evento.preventDefault(); // Evita el envío del formulario por defecto para usar fetch
        if (formulario instanceof HTMLFormElement){
            const formData = new FormData(formulario)

            // Enviar los datos usando fetch
            fetch(formulario.action, {
                method: 'POST',
                body: formData
            }).then(response => {
                if (response.ok) {
                    modal.classList.remove('hidden')
                    setTimeout(() => {
                        modal.classList.add('hidden')
                        window.location.href = '/'
                    }, 3000)
                } else {
                    console.error('Error al enviar el formulario');
                }
            }).catch(error => {
                console.error('Hubo un problema con el envío:', error);
            })
        }
     })

 
	 function HTMLbutton (valor, idbotton){
		 if (idbotton instanceof HTMLButtonElement){
			 if (valor == 1){
				idbotton.disabled = false
			 }
			 else {
				 console.log('desactivado')
				 idbotton.disabled = true
			 }
		 }
	 }
 
	 function comprobarString(evento, errorDiv)
	 {
		 if (isNaN(evento.target.value)){
			 HTMLbutton(1, boton)
             datos[evento.id] = evento.id.value
			 errorDiv.target.id.classList.add('hidden')
		 }
		 else if (evento.target.value == ''){
			 HTMLbutton(1, boton)
			 errorDiv.classList.add('hidden')
		 }
		 else{
			 HTMLbutton(0, boton)
			 errorDiv.classList.remove('hidden')
			 
		 }
	 }
	} 
	 
 </script>